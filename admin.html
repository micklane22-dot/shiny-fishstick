<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Admin ‚Äì Aurum Capital</title>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600&family=Jost:wght@300;400;500;600&display=swap" rel="stylesheet"/>
  <style>
    :root{--gold:#c9a84c;--gold2:#e8c97a;--dark:#080810;--dark2:#0f0f1e;--dark3:#16162a;--card:#1a1a2e;--text:#e8e4d8;--muted:#7a7a9a;--border:rgba(201,168,76,0.15);--green:#4caf89;--red:#e05a5a;}
    *{margin:0;padding:0;box-sizing:border-box;}
    body{font-family:'Jost',sans-serif;background:var(--dark);color:var(--text);display:flex;min-height:100vh;}
    .sidebar{width:250px;background:var(--dark2);border-right:1px solid var(--border);display:flex;flex-direction:column;position:fixed;height:100vh;z-index:200;}
    .sb-logo{padding:2rem 1.5rem;border-bottom:1px solid var(--border);}
    .sb-logo .brand{font-family:'Cormorant Garamond',serif;font-size:1.3rem;color:var(--gold);letter-spacing:3px;display:block;}
    .sb-logo small{font-size:0.65rem;color:var(--muted);letter-spacing:2px;text-transform:uppercase;}
    .sb-section{padding:1.2rem 1rem 0.3rem;font-size:0.62rem;letter-spacing:3px;text-transform:uppercase;color:var(--muted);}
    .sb-item{display:flex;align-items:center;gap:0.9rem;padding:0.8rem 1.5rem;margin:2px 0.5rem;color:var(--muted);font-size:0.85rem;cursor:pointer;border-radius:4px;transition:all 0.2s;text-decoration:none;position:relative;}
    .sb-item:hover{color:var(--text);background:rgba(201,168,76,0.06);}
    .sb-item.active{color:var(--gold);background:rgba(201,168,76,0.08);}
    .sb-item.active::before{content:'';position:absolute;left:0;top:20%;height:60%;width:2px;background:var(--gold);}
    .sb-item .icon{width:20px;text-align:center;font-size:1rem;}
    .badge{margin-left:auto;background:var(--gold);color:var(--dark);font-size:0.62rem;padding:2px 7px;border-radius:10px;font-weight:600;}
    .sb-footer{margin-top:auto;padding:1rem 1.5rem;border-top:1px solid var(--border);}
    .sb-user{display:flex;align-items:center;gap:0.8rem;margin-bottom:0.8rem;}
    .sb-avatar{width:34px;height:34px;border-radius:50%;background:linear-gradient(135deg,var(--gold),rgba(201,168,76,0.3));display:flex;align-items:center;justify-content:center;font-family:'Cormorant Garamond',serif;font-size:1rem;font-weight:600;color:var(--dark);}
    .sb-name{font-size:0.83rem;font-weight:500;}
    .sb-role{font-size:0.68rem;color:var(--muted);letter-spacing:1px;}
    .logout-btn{width:100%;background:rgba(201,168,76,0.08);border:1px solid var(--border);color:var(--gold);padding:0.55rem;border-radius:4px;cursor:pointer;font-size:0.78rem;font-family:'Jost',sans-serif;letter-spacing:1px;transition:background 0.2s;}
    .logout-btn:hover{background:rgba(201,168,76,0.15);}
    .main{margin-left:250px;flex:1;display:flex;flex-direction:column;}
    .topbar{background:var(--dark2);border-bottom:1px solid var(--border);padding:1rem 2rem;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:100;}
    .topbar h1{font-family:'Cormorant Garamond',serif;font-size:1.3rem;font-weight:400;letter-spacing:2px;color:var(--gold);}
    .topbar-right{display:flex;align-items:center;gap:1rem;}
    .icon-btn{width:36px;height:36px;border-radius:4px;background:var(--dark3);border:1px solid var(--border);display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:0.95rem;position:relative;}
    .notif-dot{position:absolute;top:6px;right:6px;width:6px;height:6px;background:var(--gold);border-radius:50%;}
    .content{padding:2rem;flex:1;}
    .tab{display:none;}
    .tab.active{display:block;}
    .breadcrumb{font-size:0.68rem;letter-spacing:2px;text-transform:uppercase;color:var(--muted);margin-bottom:1.5rem;}
    .breadcrumb span{color:var(--gold);}
    .page-hdr{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:2rem;}
    .page-hdr h2{font-family:'Cormorant Garamond',serif;font-size:1.8rem;font-weight:400;}
    .page-hdr p{font-size:0.8rem;color:var(--muted);margin-top:0.3rem;letter-spacing:1px;}
    .stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;margin-bottom:2rem;}
    .stat{background:var(--card);border:1px solid var(--border);padding:1.5rem;position:relative;overflow:hidden;transition:border-color 0.3s;}
    .stat:hover{border-color:var(--gold);}
    .stat-lbl{font-size:0.65rem;letter-spacing:2px;text-transform:uppercase;color:var(--muted);margin-bottom:0.8rem;}
    .stat-val{font-family:'Cormorant Garamond',serif;font-size:2.2rem;font-weight:600;color:var(--gold);}
    .stat-chg{font-size:0.73rem;margin-top:0.3rem;}
    .stat-chg.up{color:var(--green);}
    .stat-chg.dn{color:var(--red);}
    .stat-ico{position:absolute;top:1.2rem;right:1.2rem;font-size:1.3rem;opacity:0.4;}
    .panels{display:grid;grid-template-columns:2fr 1fr;gap:1.5rem;margin-bottom:1.5rem;}
    .panel{background:var(--card);border:1px solid var(--border);}
    .panel-hdr{padding:1.2rem 1.5rem;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;}
    .panel-hdr h3{font-size:0.78rem;letter-spacing:2px;text-transform:uppercase;color:var(--gold);}
    .panel-body{padding:1.5rem;}
    table{width:100%;border-collapse:collapse;}
    th{font-size:0.62rem;letter-spacing:2px;text-transform:uppercase;color:var(--muted);padding:0.7rem 1rem;text-align:left;border-bottom:1px solid var(--border);}
    td{padding:0.9rem 1rem;font-size:0.85rem;border-bottom:1px solid rgba(201,168,76,0.04);}
    tr:hover td{background:rgba(201,168,76,0.02);}
    tr:last-child td{border-bottom:none;}
    .chip{display:inline-flex;align-items:center;gap:0.3rem;padding:3px 10px;border-radius:2px;font-size:0.68rem;letter-spacing:1px;font-weight:500;}
    .chip::before{content:'‚óè';font-size:0.45rem;}
    .chip.new{background:rgba(201,168,76,0.12);color:var(--gold);}
    .chip.read{background:rgba(76,175,137,0.12);color:var(--green);}
    .chip.active{background:rgba(76,175,137,0.12);color:var(--green);}
    .chip.pending{background:rgba(201,168,76,0.12);color:var(--gold);}
    .chip.inactive{background:rgba(224,90,90,0.12);color:var(--red);}
    .act-item{display:flex;gap:1rem;padding:0.8rem 0;border-bottom:1px solid rgba(201,168,76,0.05);align-items:flex-start;}
    .act-item:last-child{border-bottom:none;}
    .act-dot{width:8px;height:8px;border-radius:50%;background:var(--gold);margin-top:6px;flex-shrink:0;}
    .act-dot.green{background:var(--green);}
    .act-dot.red{background:var(--red);}
    .act-title{font-size:0.83rem;}
    .act-time{font-size:0.68rem;color:var(--muted);margin-top:2px;letter-spacing:1px;}
    .prog-row{margin-bottom:1.2rem;}
    .prog-meta{display:flex;justify-content:space-between;font-size:0.75rem;margin-bottom:0.4rem;}
    .prog-meta span:last-child{color:var(--gold);font-family:'Cormorant Garamond',serif;font-size:0.9rem;}
    .prog-meta span:first-child{color:var(--muted);letter-spacing:1px;font-size:0.68rem;text-transform:uppercase;}
    .prog-bar{height:3px;background:var(--border);}
    .prog-fill{height:100%;background:var(--gold);}
    .form-grid{display:grid;grid-template-columns:1fr 1fr;gap:1.5rem;}
    .fg{margin-bottom:1.2rem;}
    .fg label{display:block;font-size:0.65rem;letter-spacing:2px;text-transform:uppercase;color:var(--muted);margin-bottom:0.5rem;}
    .fg input,.fg select,.fg textarea{width:100%;background:var(--dark);border:1px solid var(--border);color:var(--text);padding:0.75rem 1rem;font-size:0.85rem;outline:none;transition:border-color 0.3s;font-family:'Jost',sans-serif;}
    .fg input:focus,.fg select:focus,.fg textarea:focus{border-color:var(--gold);}
    .fg textarea{resize:vertical;min-height:100px;}
    .fg select option{background:var(--dark2);}
    .toggle-row{display:flex;justify-content:space-between;align-items:center;padding:0.8rem 0;border-bottom:1px solid rgba(201,168,76,0.05);}
    .toggle-row:last-child{border-bottom:none;}
    .toggle-lbl{font-size:0.83rem;}
    .toggle-sub{font-size:0.7rem;color:var(--muted);margin-top:2px;}
    .tog{width:38px;height:20px;background:var(--border);border-radius:20px;cursor:pointer;position:relative;transition:background 0.3s;flex-shrink:0;}
    .tog.on{background:var(--gold);}
    .tog::after{content:'';position:absolute;top:3px;left:3px;width:14px;height:14px;background:white;border-radius:50%;transition:transform 0.3s;}
    .tog.on::after{transform:translateX(18px);}
    .btn-gold{background:var(--gold);color:var(--dark);border:none;padding:0.65rem 1.5rem;font-size:0.75rem;letter-spacing:2px;text-transform:uppercase;cursor:pointer;font-family:'Jost',sans-serif;font-weight:600;transition:background 0.2s;}
    .btn-gold:hover{background:var(--gold2);}
    .btn-outline{background:transparent;color:var(--muted);border:1px solid var(--border);padding:0.6rem 1rem;font-size:0.73rem;letter-spacing:1px;cursor:pointer;font-family:'Jost',sans-serif;transition:all 0.2s;}
    .btn-outline:hover{border-color:var(--gold);color:var(--gold);}
    .clients-toolbar{padding:1.2rem 1.5rem;display:flex;align-items:center;gap:1rem;border-bottom:1px solid var(--border);}
    .search-box{display:flex;align-items:center;gap:0.5rem;background:var(--dark3);border:1px solid var(--border);padding:0.5rem 1rem;border-radius:4px;flex:1;max-width:280px;}
    .search-box input{background:none;border:none;outline:none;color:var(--text);font-size:0.83rem;width:100%;font-family:'Jost',sans-serif;}
    .search-box input::placeholder{color:var(--muted);}
    .msg-card{background:var(--card);border:1px solid var(--border);padding:1.5rem;margin-bottom:1rem;display:flex;gap:1.2rem;transition:border-color 0.3s;cursor:pointer;}
    .msg-card:hover{border-color:var(--gold);}
    .msg-card.unread{border-left:2px solid var(--gold);}
    .msg-av{width:42px;height:42px;border-radius:50%;background:linear-gradient(135deg,var(--dark3),var(--gold));display:flex;align-items:center;justify-content:center;font-family:'Cormorant Garamond',serif;font-size:1.1rem;color:var(--dark);font-weight:600;flex-shrink:0;}
    .msg-name{font-size:0.88rem;font-weight:500;}
    .msg-em{font-size:0.72rem;color:var(--muted);margin-bottom:0.3rem;}
    .msg-txt{font-size:0.82rem;color:#aaa;line-height:1.6;}
    .msg-time{margin-left:auto;font-size:0.68rem;color:var(--muted);white-space:nowrap;}
    .perf-bars{display:flex;align-items:flex-end;gap:8px;height:140px;border-bottom:1px solid var(--border);padding-bottom:0.5rem;margin-bottom:1.5rem;}
    .pb-wrap{flex:1;display:flex;flex-direction:column;align-items:center;gap:0.3rem;height:100%;justify-content:flex-end;}
    .pb{width:100%;border-radius:1px 1px 0 0;background:linear-gradient(180deg,var(--gold) 0%,rgba(201,168,76,0.2) 100%);cursor:pointer;}
    .pb-lbl{font-size:0.6rem;color:var(--muted);letter-spacing:1px;}
    .toast{position:fixed;bottom:2rem;right:2rem;background:var(--card);border:1px solid var(--gold);padding:1rem 1.5rem;display:flex;align-items:center;gap:0.8rem;font-size:0.83rem;color:var(--gold);letter-spacing:1px;transform:translateY(100px);opacity:0;transition:all 0.4s;z-index:999;}
    .toast.show{transform:translateY(0);opacity:1;}
    .loading-row td{text-align:center;color:var(--muted);font-size:0.82rem;padding:2rem;}
    @media(max-width:900px){.sidebar{transform:translateX(-100%)}.main{margin-left:0}.panels{grid-template-columns:1fr}.form-grid{grid-template-columns:1fr}}
  </style>
</head>
<body>

<aside class="sidebar">
  <div class="sb-logo">
    <span class="brand">AURUM CAPITAL</span>
    <small>Admin Dashboard</small>
  </div>
  <div class="sb-section">Overview</div>
  <a class="sb-item active" onclick="showTab('dashboard',this)"><span class="icon">üìä</span>Dashboard</a>
  <a class="sb-item" onclick="showTab('inquiries',this)"><span class="icon">‚úâÔ∏è</span>Inquiries<span class="badge" id="inqBadge">0</span></a>
  <a class="sb-item" onclick="showTab('clients',this)"><span class="icon">üë•</span>Clients</a>
  <div class="sb-section">System</div>
  <a class="sb-item" onclick="showTab('settings',this)"><span class="icon">‚öôÔ∏è</span>Settings</a>
  <div class="sb-footer">
    <div class="sb-user">
      <div class="sb-avatar">A</div>
      <div><div class="sb-name">Admin</div><div class="sb-role">Super Admin</div></div>
    </div>
    <button class="logout-btn" onclick="logout()">üö™ &nbsp; Logout</button>
  </div>
</aside>

<div class="main">
  <header class="topbar">
    <h1 id="pageTitle">DASHBOARD</h1>
    <div class="topbar-right">
      <div class="icon-btn">üîî<span class="notif-dot" id="notifDot"></span></div>
    </div>
  </header>

  <div class="content">

    <!-- DASHBOARD -->
    <div class="tab active" id="tab-dashboard">
      <div class="breadcrumb">Aurum Capital / <span>Dashboard</span></div>
      <div class="page-hdr"><div><h2>Good Morning, Admin</h2><p>Live data from Firebase</p></div></div>
      <div class="stats">
        <div class="stat"><div class="stat-ico">üí∞</div><div class="stat-lbl">Total AUM</div><div class="stat-val">$2.41B</div><div class="stat-chg up">‚ñ≤ +$142M this month</div></div>
        <div class="stat"><div class="stat-ico">‚úâÔ∏è</div><div class="stat-lbl">Total Inquiries</div><div class="stat-val" id="totalInquiries">‚Äî</div><div class="stat-chg up">Live from Firebase</div></div>
        <div class="stat"><div class="stat-ico">üÜï</div><div class="stat-lbl">New Inquiries</div><div class="stat-val" id="newInquiries">‚Äî</div><div class="stat-chg dn">Awaiting response</div></div>
        <div class="stat"><div class="stat-ico">üë•</div><div class="stat-lbl">Total Clients</div><div class="stat-val" id="totalClients">‚Äî</div><div class="stat-chg up">Live from Firebase</div></div>
      </div>
      <div class="panels">
        <div class="panel">
          <div class="panel-hdr"><h3>Portfolio Performance</h3></div>
          <div class="panel-body">
            <div class="perf-bars" id="dashChart"></div>
            <div style="display:flex;gap:2rem;">
              <div style="display:flex;align-items:center;gap:0.5rem;font-size:0.68rem;color:var(--muted);"><div style="width:10px;height:10px;background:var(--gold);"></div>Aurum Returns</div>
              <div style="display:flex;align-items:center;gap:0.5rem;font-size:0.68rem;color:var(--muted);"><div style="width:10px;height:10px;background:rgba(201,168,76,0.2);"></div>S&P 500</div>
            </div>
          </div>
        </div>
        <div class="panel">
          <div class="panel-hdr"><h3>Recent Inquiries</h3></div>
          <div class="panel-body" style="padding:0.5rem 1.5rem;" id="recentActivity">
            <div style="color:var(--muted);font-size:0.82rem;text-align:center;padding:1rem;">Loading...</div>
          </div>
        </div>
      </div>
      <div class="panel">
        <div class="panel-hdr"><h3>AUM by Asset Class</h3></div>
        <div class="panel-body">
          <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:2rem;">
            <div class="prog-row"><div class="prog-meta"><span>Equity Portfolios</span><span>$892M</span></div><div class="prog-bar"><div class="prog-fill" style="width:37%"></div></div></div>
            <div class="prog-row"><div class="prog-meta"><span>Fixed Income</span><span>$615M</span></div><div class="prog-bar"><div class="prog-fill" style="width:25%"></div></div></div>
            <div class="prog-row"><div class="prog-meta"><span>Alternative Assets</span><span>$483M</span></div><div class="prog-bar"><div class="prog-fill" style="width:20%"></div></div></div>
            <div class="prog-row"><div class="prog-meta"><span>Real Estate</span><span>$290M</span></div><div class="prog-bar"><div class="prog-fill" style="width:12%"></div></div></div>
            <div class="prog-row"><div class="prog-meta"><span>Digital Assets</span><span>$130M</span></div><div class="prog-bar"><div class="prog-fill" style="width:6%"></div></div></div>
          </div>
        </div>
      </div>
    </div>

    <!-- INQUIRIES -->
    <div class="tab" id="tab-inquiries">
      <div class="breadcrumb">Aurum Capital / <span>Inquiries</span></div>
      <div class="page-hdr">
        <div><h2>Inquiries</h2><p>Real submissions from your website contact form</p></div>
        <button class="btn-outline" onclick="loadInquiries()">‚Üª Refresh</button>
      </div>
      <div id="inquiriesList">
        <div style="color:var(--muted);font-size:0.85rem;text-align:center;padding:3rem;">Loading inquiries...</div>
      </div>
    </div>

    <!-- CLIENTS -->
    <div class="tab" id="tab-clients">
      <div class="breadcrumb">Aurum Capital / <span>Clients</span></div>
      <div class="page-hdr">
        <div><h2>Clients</h2><p>Manage all client accounts</p></div>
        <button class="btn-gold" onclick="showAddClient()">+ Add Client</button>
      </div>

      <!-- ADD CLIENT FORM -->
      <div id="addClientForm" style="display:none;background:var(--card);border:1px solid var(--border);padding:1.5rem;margin-bottom:1.5rem;">
        <div style="font-size:0.72rem;letter-spacing:2px;text-transform:uppercase;color:var(--gold);margin-bottom:1.2rem;">New Client</div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem;">
          <div class="fg"><label>Full Name</label><input type="text" id="clientName" placeholder="James Mercer"/></div>
          <div class="fg"><label>Email</label><input type="email" id="clientEmail" placeholder="james@example.com"/></div>
          <div class="fg"><label>Phone</label><input type="tel" id="clientPhone" placeholder="+1 (555) 000-0000"/></div>
          <div class="fg"><label>Portfolio Value</label><input type="text" id="clientValue" placeholder="$500,000"/></div>
          <div class="fg"><label>Service</label>
            <select id="clientService">
              <option>Equity Portfolios</option><option>Fixed Income</option>
              <option>Alternative Assets</option><option>Wealth Planning</option>
              <option>Real Estate</option><option>Digital Assets</option>
            </select>
          </div>
          <div class="fg"><label>Status</label>
            <select id="clientStatus"><option value="active">Active</option><option value="pending">Pending</option><option value="inactive">Inactive</option></select>
          </div>
        </div>
        <div style="display:flex;gap:1rem;">
          <button class="btn-gold" onclick="saveClient()">Save Client</button>
          <button class="btn-outline" onclick="document.getElementById('addClientForm').style.display='none'">Cancel</button>
        </div>
      </div>

      <div style="background:var(--card);border:1px solid var(--border);">
        <div class="clients-toolbar">
          <div class="search-box"><span style="color:var(--muted)">üîç</span><input type="text" placeholder="Search clients..." oninput="filterClientsTable(this.value)"/></div>
          <button class="btn-outline" onclick="loadClients()">‚Üª Refresh</button>
        </div>
        <table>
          <thead><tr><th>Name</th><th>Email</th><th>Portfolio</th><th>Service</th><th>Status</th><th>Action</th></tr></thead>
          <tbody id="clientsBody"><tr><td colspan="6" style="text-align:center;color:var(--muted);padding:2rem;">Loading clients...</td></tr></tbody>
        </table>
      </div>
    </div>

    <!-- SETTINGS -->
    <div class="tab" id="tab-settings">
      <div class="breadcrumb">Aurum Capital / <span>Settings</span></div>
      <div class="page-hdr">
        <div><h2>Settings</h2><p>Website and system configuration</p></div>
        <button class="btn-gold" onclick="showToast('Settings saved!')">Save Changes</button>
      </div>
      <div class="form-grid">
        <div class="panel" style="padding:1.5rem;">
          <div style="font-size:0.72rem;letter-spacing:2px;text-transform:uppercase;color:var(--gold);margin-bottom:1.5rem;">Company Information</div>
          <div class="fg"><label>Company Name</label><input type="text" value="Aurum Capital Group"/></div>
          <div class="fg"><label>Tagline</label><input type="text" value="Your Wealth, Intelligently Managed"/></div>
          <div class="fg"><label>Contact Email</label><input type="email" value="advisors@aurumcapital.com"/></div>
          <div class="fg"><label>Phone</label><input type="tel" value="+1 (212) 555-0190"/></div>
          <div class="fg"><label>Minimum Investment ($)</label><input type="number" value="50000"/></div>
        </div>
        <div>
          <div class="panel" style="padding:1.5rem;margin-bottom:1.5rem;">
            <div style="font-size:0.72rem;letter-spacing:2px;text-transform:uppercase;color:var(--gold);margin-bottom:1.5rem;">Notifications</div>
            <div class="toggle-row"><div><div class="toggle-lbl">New Inquiry Alert</div><div class="toggle-sub">Email when form submitted</div></div><div class="tog on" onclick="this.classList.toggle('on')"></div></div>
            <div class="toggle-row"><div><div class="toggle-lbl">New Client Alert</div><div class="toggle-sub">Alert when client added</div></div><div class="tog on" onclick="this.classList.toggle('on')"></div></div>
            <div class="toggle-row"><div><div class="toggle-lbl">Daily Market Report</div><div class="toggle-sub">Morning briefing at 7AM</div></div><div class="tog" onclick="this.classList.toggle('on')"></div></div>
          </div>
          <div class="panel" style="padding:1.5rem;">
            <div style="font-size:0.72rem;letter-spacing:2px;text-transform:uppercase;color:var(--gold);margin-bottom:1.5rem;">Admin Credentials</div>
            <div class="fg"><label>Username</label><input type="text" value="admin"/></div>
            <div class="fg"><label>New Password</label><input type="password" placeholder="Enter new password"/></div>
            <div class="fg"><label>Confirm Password</label><input type="password" placeholder="Confirm new password"/></div>
            <button class="btn-gold" onclick="showToast('Password updated!')">Update Password</button>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>

<div class="toast" id="toast">‚ú¶ <span id="toastMsg"></span></div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
  import { getFirestore, collection, addDoc, getDocs, updateDoc, deleteDoc, doc, query, orderBy, where, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyA2ZH60oD_JUD3jCAy2XDPSyxg0zEDAXus",
    authDomain: "aurumcapital-9b384.firebaseapp.com",
    projectId: "aurumcapital-9b384",
    storageBucket: "aurumcapital-9b384.firebasestorage.app",
    messagingSenderId: "305396143870",
    appId: "1:305396143870:web:25f67c8033da232f7137af"
  };
  const app = initializeApp(firebaseConfig);
  const db  = getFirestore(app);

  // LOGIN CHECK
  if (!sessionStorage.getItem('aurumAdmin')) { window.location.href = 'login.html'; }

  window.logout = function() { sessionStorage.removeItem('aurumAdmin'); window.location.href = 'login.html'; };

  // TABS
  window.showTab = function(id, el) {
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.getElementById('tab-'+id).classList.add('active');
    document.querySelectorAll('.sb-item').forEach(n => n.classList.remove('active'));
    if (el) el.classList.add('active');
    const titles = {dashboard:'DASHBOARD',inquiries:'INQUIRIES',clients:'CLIENTS',settings:'SETTINGS'};
    document.getElementById('pageTitle').textContent = titles[id] || id.toUpperCase();
    if (id === 'inquiries') loadInquiries();
    if (id === 'clients')   loadClients();
  };

  // TOAST
  window.showToast = function(msg) {
    const t = document.getElementById('toast');
    document.getElementById('toastMsg').textContent = msg;
    t.classList.add('show');
    setTimeout(() => t.classList.remove('show'), 3000);
  };

  // FORMAT TIME
  function timeAgo(ts) {
    if (!ts) return 'Just now';
    const now = Date.now();
    const diff = now - ts.toMillis();
    const mins = Math.floor(diff / 60000);
    const hrs  = Math.floor(diff / 3600000);
    const days = Math.floor(diff / 86400000);
    if (mins < 1)  return 'Just now';
    if (mins < 60) return `${mins}m ago`;
    if (hrs < 24)  return `${hrs}h ago`;
    return `${days}d ago`;
  }

  // LOAD INQUIRIES
  window.loadInquiries = async function() {
    const list = document.getElementById('inquiriesList');
    list.innerHTML = '<div style="color:var(--muted);font-size:0.85rem;text-align:center;padding:3rem;">Loading...</div>';
    try {
      const q = query(collection(db, 'inquiries'), orderBy('timestamp', 'desc'));
      const snap = await getDocs(q);
      if (snap.empty) {
        list.innerHTML = '<div style="color:var(--muted);font-size:0.85rem;text-align:center;padding:3rem;">No inquiries yet. They will appear here when someone fills your contact form.</div>';
        document.getElementById('totalInquiries').textContent = '0';
        document.getElementById('newInquiries').textContent = '0';
        document.getElementById('inqBadge').textContent = '0';
        updateRecentActivity([]);
        return;
      }
      let newCount = 0;
      const items = [];
      snap.forEach(d => { items.push({id: d.id, ...d.data()}); if (d.data().status === 'new') newCount++; });
      document.getElementById('totalInquiries').textContent = items.length;
      document.getElementById('newInquiries').textContent = newCount;
      document.getElementById('inqBadge').textContent = newCount;
      if (newCount > 0) document.getElementById('notifDot').style.display = 'block';
      updateRecentActivity(items.slice(0,5));
      list.innerHTML = items.map(item => `
        <div class="msg-card ${item.status === 'new' ? 'unread' : ''}" id="inq-${item.id}">
          <div class="msg-av">${(item.firstName||'?')[0].toUpperCase()}</div>
          <div style="flex:1;">
            <div style="display:flex;align-items:center;gap:0.5rem;margin-bottom:3px;">
              <div class="msg-name">${item.firstName || ''} ${item.lastName || ''}</div>
              ${item.status === 'new' ? '<span style="font-size:0.62rem;background:var(--gold);color:var(--dark);padding:1px 7px;font-weight:600;letter-spacing:1px;">NEW</span>' : ''}
            </div>
            <div class="msg-em">${item.email || ''} ${item.interest ? '¬∑ '+item.interest : ''}</div>
            <div class="msg-txt">${item.message || 'No message provided.'}</div>
            ${item.phone ? `<div style="font-size:0.72rem;color:var(--muted);margin-top:0.3rem;">üìû ${item.phone}</div>` : ''}
          </div>
          <div style="display:flex;flex-direction:column;align-items:flex-end;gap:0.5rem;">
            <div class="msg-time">${timeAgo(item.timestamp)}</div>
            ${item.status === 'new' ? `<button class="btn-outline" style="padding:3px 8px;font-size:0.68rem;" onclick="markRead('${item.id}')">Mark Read</button>` : '<span style="font-size:0.68rem;color:var(--green);">‚úì Read</span>'}
          </div>
        </div>
      `).join('');
    } catch(e) {
      list.innerHTML = `<div style="color:var(--red);font-size:0.85rem;text-align:center;padding:3rem;">Error loading inquiries: ${e.message}</div>`;
    }
  };

  // MARK AS READ
  window.markRead = async function(id) {
    try {
      await updateDoc(doc(db, 'inquiries', id), { status: 'read' });
      showToast('Marked as read!');
      loadInquiries();
    } catch(e) { showToast('Error: '+e.message); }
  };

  // RECENT ACTIVITY ON DASHBOARD
  function updateRecentActivity(items) {
    const el = document.getElementById('recentActivity');
    if (!items.length) { el.innerHTML = '<div style="color:var(--muted);font-size:0.82rem;text-align:center;padding:1rem;">No inquiries yet.</div>'; return; }
    el.innerHTML = items.map(item => `
      <div class="act-item">
        <div class="act-dot ${item.status==='new'?'':'green'}"></div>
        <div>
          <div class="act-title">${item.status==='new'?'New inquiry':'Inquiry'} from ${item.firstName||''} ${item.lastName||''}</div>
          <div class="act-time">${timeAgo(item.timestamp)} ${item.interest?'¬∑ '+item.interest:''}</div>
        </div>
      </div>
    `).join('');
  }

  // LOAD CLIENTS
  window.allClients = [];
  window.loadClients = async function() {
    const tbody = document.getElementById('clientsBody');
    tbody.innerHTML = '<tr><td colspan="6" style="text-align:center;color:var(--muted);padding:2rem;">Loading...</td></tr>';
    try {
      const snap = await getDocs(collection(db, 'clients'));
      if (snap.empty) {
        tbody.innerHTML = '<tr><td colspan="6" style="text-align:center;color:var(--muted);padding:2rem;">No clients yet. Add your first client!</td></tr>';
        document.getElementById('totalClients').textContent = '0';
        window.allClients = [];
        return;
      }
      window.allClients = [];
      snap.forEach(d => window.allClients.push({id: d.id, ...d.data()}));
      document.getElementById('totalClients').textContent = window.allClients.length;
      renderClients(window.allClients);
    } catch(e) {
      tbody.innerHTML = `<tr><td colspan="6" style="text-align:center;color:var(--red);padding:2rem;">Error: ${e.message}</td></tr>`;
    }
  };

  function renderClients(list) {
    const tbody = document.getElementById('clientsBody');
    if (!list.length) { tbody.innerHTML = '<tr><td colspan="6" style="text-align:center;color:var(--muted);padding:2rem;">No clients found.</td></tr>'; return; }
    tbody.innerHTML = list.map(c => `
      <tr>
        <td><strong>${c.name||''}</strong></td>
        <td style="color:var(--muted)">${c.email||''}</td>
        <td style="font-family:'Cormorant Garamond',serif;font-size:1.05rem;color:var(--gold)">${c.portfolioValue||'‚Äî'}</td>
        <td style="color:var(--muted);font-size:0.8rem">${c.service||'‚Äî'}</td>
        <td><span class="chip ${c.status||'active'}">${(c.status||'active').charAt(0).toUpperCase()+(c.status||'active').slice(1)}</span></td>
        <td>
          <button class="btn-outline" style="padding:4px 10px;font-size:0.72rem;" onclick="deleteClient('${c.id}')">Remove</button>
        </td>
      </tr>
    `).join('');
  }

  window.filterClientsTable = function(val) {
    renderClients(window.allClients.filter(c =>
      (c.name||'').toLowerCase().includes(val.toLowerCase()) ||
      (c.email||'').toLowerCase().includes(val.toLowerCase())
    ));
  };

  // ADD CLIENT
  window.showAddClient = function() {
    const f = document.getElementById('addClientForm');
    f.style.display = f.style.display === 'none' ? 'block' : 'none';
  };

  window.saveClient = async function() {
    const name  = document.getElementById('clientName').value.trim();
    const email = document.getElementById('clientEmail').value.trim();
    const phone = document.getElementById('clientPhone').value.trim();
    const value = document.getElementById('clientValue').value.trim();
    const service = document.getElementById('clientService').value;
    const status  = document.getElementById('clientStatus').value;
    if (!name || !email) { showToast('Name and email are required!'); return; }
    try {
      await addDoc(collection(db, 'clients'), { name, email, phone, portfolioValue: value, service, status, timestamp: serverTimestamp() });
      showToast('Client saved successfully!');
      document.getElementById('addClientForm').style.display = 'none';
      document.getElementById('clientName').value = '';
      document.getElementById('clientEmail').value = '';
      document.getElementById('clientPhone').value = '';
      document.getElementById('clientValue').value = '';
      loadClients();
    } catch(e) { showToast('Error: '+e.message); }
  };

  window.deleteClient = async function(id) {
    if (!confirm('Remove this client?')) return;
    try {
      await deleteDoc(doc(db, 'clients', id));
      showToast('Client removed!');
      loadClients();
    } catch(e) { showToast('Error: '+e.message); }
  };

  // CHART
  const years=['2017','2018','2019','2020','2021','2022','2023'],aurum=[22.4,8.1,31.2,18.5,28.9,4.2,24.7],sp500=[19.4,6.2,28.9,16.3,26.9,8,24.2],maxV=Math.max(...aurum,...sp500);
  document.getElementById('dashChart').innerHTML=years.map((y,i)=>`<div class="pb-wrap"><div style="display:flex;align-items:flex-end;gap:2px;height:100%;width:100%;"><div class="pb" style="height:${(aurum[i]/maxV)*100}%;flex:1;"></div><div class="pb" style="height:${(sp500[i]/maxV)*100}%;flex:1;background:rgba(201,168,76,0.2);"></div></div><span class="pb-lbl">${y}</span></div>`).join('');

  // INITIAL LOAD
  loadInquiries();
  loadClients();
</script>
<!-- SMARTSUPP LIVE CHAT -->
<script type="text/javascript">
var _smartsupp = _smartsupp || {};
_smartsupp.key = 'f2a26d6fc0d8de6cf7437e7d78e549fbbe366ad2';
window.smartsupp||(function(d) {
  var s,c,o=smartsupp=function(){ o._.push(arguments)};o._=[];
  s=d.getElementsByTagName('script')[0];c=d.createElement('script');
  c.type='text/javascript';c.charset='utf-8';c.async=true;
  c.src='https://www.smartsuppchat.com/loader.js?';s.parentNode.insertBefore(c,s);
})(document);
</script>
</body>
</html>
